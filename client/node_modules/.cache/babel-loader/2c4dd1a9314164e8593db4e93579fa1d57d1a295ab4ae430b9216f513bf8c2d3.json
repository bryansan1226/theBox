{"ast":null,"code":"import _regeneratorRuntime from\"/Users/bryansanchezandrade/Documents/theBox/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/bryansanchezandrade/Documents/theBox/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/bryansanchezandrade/Documents/theBox/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import{useEffect,useState}from\"react\";import backendUrl from\"../config\";import{useNavigate}from\"react-router-dom\";import Button from\"@mui/material/Button\";import NewPostForm from\"../components/NewPostForm\";import PostFeed from\"../components/PostFeed\";import AppBar from\"../components/AppBar\";import Typography from\"@mui/material/Typography\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Homepage(){//State to store user information\nvar _useState=useState(null),_useState2=_slicedToArray(_useState,2),userInfo=_useState2[0],setUserInfo=_useState2[1];var navigate=useNavigate();var fetchUserInfo=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;//Retrieves token from localstorage, if no token is present the user will be redirected to /login\ntoken=localStorage.getItem(\"token\");if(token){_context.next=5;break;}//redirect\nnavigate(\"/\");return _context.abrupt(\"return\",null);case 5:_context.next=7;return axios.get(\"\".concat(backendUrl,\"api/user\"),{headers:{Authorization:\"Bearer \".concat(token)}});case 7:response=_context.sent;return _context.abrupt(\"return\",response.data);case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.error(\"Error fetching user information\",_context.t0);return _context.abrupt(\"return\",null);case 15:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return function fetchUserInfo(){return _ref.apply(this,arguments);};}();//Function to get user info using fetchUserInfo and updates userInfo state.\nvar getUserInfo=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var info;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetchUserInfo();case 2:info=_context2.sent;if(info){setUserInfo(info);console.log(\"User info \",info);}else{console.log(\"User not authenticated or an error occured.\");}case 4:case\"end\":return _context2.stop();}},_callee2);}));return function getUserInfo(){return _ref2.apply(this,arguments);};}();//Effect hook to get user info when component mounts\nuseEffect(function(){getUserInfo();},[]);//Handles signing out by removing the session token from localstorage and navigates to index page.\nvar handleSignOut=function handleSignOut(){setUserInfo(null);localStorage.removeItem(\"token\");navigate(\"/\");};if(userInfo===null){return/*#__PURE__*/_jsx(\"h1\",{children:\"Loading...\"});}else{return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AppBar,{}),/*#__PURE__*/_jsxs(Typography,{variant:\"h4\",gutterBottom:true,children:[\"Welcome, \",userInfo.first_name,\"!\"]}),/*#__PURE__*/_jsx(PostFeed,{userInfo:userInfo})]});}}export default Homepage;","map":{"version":3,"names":["axios","useEffect","useState","backendUrl","useNavigate","Button","NewPostForm","PostFeed","AppBar","Typography","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Homepage","_useState","_useState2","_slicedToArray","userInfo","setUserInfo","navigate","fetchUserInfo","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","token","response","wrap","_callee$","_context","prev","next","localStorage","getItem","abrupt","get","concat","headers","Authorization","sent","data","t0","console","error","stop","apply","arguments","getUserInfo","_ref2","_callee2","info","_callee2$","_context2","log","handleSignOut","removeItem","children","variant","gutterBottom","first_name"],"sources":["/Users/bryansanchezandrade/Documents/theBox/client/src/pages/Homepage.js"],"sourcesContent":["import axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport backendUrl from \"../config\";\nimport { useNavigate } from \"react-router-dom\";\nimport Button from \"@mui/material/Button\";\nimport NewPostForm from \"../components/NewPostForm\";\nimport PostFeed from \"../components/PostFeed\";\nimport AppBar from \"../components/AppBar\";\nimport Typography from \"@mui/material/Typography\";\n\nfunction Homepage() {\n  //State to store user information\n  const [userInfo, setUserInfo] = useState(null);\n  const navigate = useNavigate();\n\n  const fetchUserInfo = async () => {\n    //  console.log(\"got to fetch\");\n    try {\n      //Retrieves token from localstorage, if no token is present the user will be redirected to /login\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        //redirect\n        navigate(\"/\");\n        return null;\n      }\n      //Makes a GET request to fetch user data using token\n      const response = await axios.get(`${backendUrl}api/user`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      // Returns user data if successful\n      return response.data;\n      //console.log(response.data);\n    } catch (error) {\n      console.error(\"Error fetching user information\", error);\n      return null;\n    }\n  };\n  //Function to get user info using fetchUserInfo and updates userInfo state.\n  const getUserInfo = async () => {\n    const info = await fetchUserInfo();\n    if (info) {\n      setUserInfo(info);\n      console.log(\"User info \", info);\n    } else {\n      console.log(\"User not authenticated or an error occured.\");\n    }\n  };\n  //Effect hook to get user info when component mounts\n  useEffect(() => {\n    getUserInfo();\n  }, []);\n  //Handles signing out by removing the session token from localstorage and navigates to index page.\n  const handleSignOut = () => {\n    setUserInfo(null);\n    localStorage.removeItem(\"token\");\n    navigate(\"/\");\n  };\n\n  if (userInfo === null) {\n    return <h1>Loading...</h1>;\n  } else {\n    return (\n      <>\n        <AppBar />\n        <Typography variant=\"h4\" gutterBottom>\n          Welcome, {userInfo.first_name}!\n        </Typography>\n        <PostFeed userInfo={userInfo} />\n      </>\n    );\n  }\n}\nexport default Homepage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}