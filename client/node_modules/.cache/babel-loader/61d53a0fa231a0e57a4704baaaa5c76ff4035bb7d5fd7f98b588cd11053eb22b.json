{"ast":null,"code":"import _regeneratorRuntime from\"/Users/bryansanchezandrade/Documents/theBox/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/bryansanchezandrade/Documents/theBox/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/bryansanchezandrade/Documents/theBox/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useLocation}from\"react-router-dom\";import{useEffect,useState}from\"react\";import backendUrl from\"../config\";import axios from\"axios\";import UserCard from\"../components/UserCard\";import AppBar from\"../components/AppBar\";import{Typography}from\"@mui/material\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SearchResults(){var _useLocation=useLocation(),search=_useLocation.search;var queryParams=new URLSearchParams(search);var searchQuery=queryParams.get(\"searchQuery\");var userInfo=queryParams.get(\"userInfo\");var _useState=useState([]),_useState2=_slicedToArray(_useState,2),results=_useState2[0],setResults=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),userName=_useState4[0],setUserName=_useState4[1];var navigate=useNavigate();var searchForUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:axios.get(\"\".concat(backendUrl,\"api/search/users/\").concat(searchQuery)).then(function(response){var message=response.data.rows;setResults(message);console.log(\"Response from server:\",message);}).catch(function(error){console.error(\"Error fetching data: \",error);});case 1:case\"end\":return _context.stop();}},_callee);}));return function searchForUser(){return _ref.apply(this,arguments);};}();var fetchUserInfo=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var token,response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;//Retrieves token from localstorage, if no token is present the user will be redirected to /login\ntoken=localStorage.getItem(\"token\");if(token){_context2.next=5;break;}//redirect\nnavigate(\"/\");return _context2.abrupt(\"return\",null);case 5:_context2.next=7;return axios.get(\"\".concat(backendUrl,\"api/user\"),{headers:{Authorization:\"Bearer \".concat(token)}});case 7:response=_context2.sent;return _context2.abrupt(\"return\",response.data);case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);console.error(\"Error fetching user information\",_context2.t0);return _context2.abrupt(\"return\",null);case 15:case\"end\":return _context2.stop();}},_callee2,null,[[0,11]]);}));return function fetchUserInfo(){return _ref2.apply(this,arguments);};}();//Function to get user info using fetchUserInfo and updates userInfo state.\nvar getUserInfo=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var info;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetchUserInfo();case 2:info=_context3.sent;if(info){setUserName(info.first_name+\" \"+info.last_name);// console.log(\"User info \", info);\n}else{console.log(\"User not authenticated or an error occured.\");}case 4:case\"end\":return _context3.stop();}},_callee3);}));return function getUserInfo(){return _ref3.apply(this,arguments);};}();useEffect(function(){searchForUser();getUserInfo();},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AppBar,{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\"Results:\"})}),/*#__PURE__*/_jsx(\"div\",{children:results.map(function(result,index){return/*#__PURE__*/_jsx(UserCard,{result:result,userInfo:userInfo,userName:userName},index);})})]});}export default SearchResults;","map":{"version":3,"names":["useLocation","useEffect","useState","backendUrl","axios","UserCard","AppBar","Typography","useNavigate","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","SearchResults","_useLocation","search","queryParams","URLSearchParams","searchQuery","get","userInfo","_useState","_useState2","_slicedToArray","results","setResults","_useState3","_useState4","userName","setUserName","navigate","searchForUser","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","concat","then","response","message","data","rows","console","log","catch","error","stop","apply","arguments","fetchUserInfo","_ref2","_callee2","token","_callee2$","_context2","localStorage","getItem","abrupt","headers","Authorization","sent","t0","getUserInfo","_ref3","_callee3","info","_callee3$","_context3","first_name","last_name","children","variant","map","result","index"],"sources":["/Users/bryansanchezandrade/Documents/theBox/client/src/pages/SearchResults.js"],"sourcesContent":["import { useLocation } from \"react-router-dom\";\nimport { useEffect, useState } from \"react\";\nimport backendUrl from \"../config\";\nimport axios from \"axios\";\nimport UserCard from \"../components/UserCard\";\nimport AppBar from \"../components/AppBar\";\nimport { Typography } from \"@mui/material\";\nimport { useNavigate } from \"react-router-dom\";\n\nfunction SearchResults() {\n  const { search } = useLocation();\n  const queryParams = new URLSearchParams(search);\n  const searchQuery = queryParams.get(\"searchQuery\");\n  const userInfo = queryParams.get(\"userInfo\");\n  const [results, setResults] = useState([]);\n  const [userName, setUserName] = useState(\"\");\n  const navigate = useNavigate();\n\n  const searchForUser = async () => {\n    axios\n      .get(`${backendUrl}api/search/users/${searchQuery}`)\n      .then((response) => {\n        const message = response.data.rows;\n        setResults(message);\n        console.log(\"Response from server:\", message);\n      })\n      .catch((error) => {\n        console.error(\"Error fetching data: \", error);\n      });\n  };\n\n  const fetchUserInfo = async () => {\n    //  console.log(\"got to fetch\");\n    try {\n      //Retrieves token from localstorage, if no token is present the user will be redirected to /login\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        //redirect\n        navigate(\"/\");\n        return null;\n      }\n      //Makes a GET request to fetch user data using token\n      const response = await axios.get(`${backendUrl}api/user`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      // Returns user data if successful\n      return response.data;\n      //console.log(response.data);\n    } catch (error) {\n      console.error(\"Error fetching user information\", error);\n      return null;\n    }\n  };\n  //Function to get user info using fetchUserInfo and updates userInfo state.\n  const getUserInfo = async () => {\n    const info = await fetchUserInfo();\n    if (info) {\n      setUserName(info.first_name + \" \" + info.last_name);\n      // console.log(\"User info \", info);\n    } else {\n      console.log(\"User not authenticated or an error occured.\");\n    }\n  };\n  useEffect(() => {\n    searchForUser();\n    getUserInfo();\n  }, []);\n\n  return (\n    <>\n      <AppBar />\n      <div>\n        <Typography variant=\"h4\">Results:</Typography>\n      </div>\n      <div>\n        {results.map((result, index) => (\n          <UserCard\n            key={index}\n            result={result}\n            userInfo={userInfo}\n            userName={userName}\n          />\n        ))}\n      </div>\n    </>\n  );\n}\nexport default SearchResults;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}